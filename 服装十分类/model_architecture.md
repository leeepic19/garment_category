# CNN 模型架构分析

## 网络结构概览

```
输入: [batch, 1, 28, 28]
  ↓
卷积块1: Conv2d(1→32, 5×5) → ReLU → MaxPool(2×2) → Dropout(0.3)
  输出: [batch, 32, 12, 12]
  ↓
卷积块2: Conv2d(32→64, 5×5) → ReLU → MaxPool(2×2) → Dropout(0.3)
  输出: [batch, 64, 4, 4]
  ↓
展平: [batch, 1024]
  ↓
全连接1: Linear(1024→512) → ReLU
  输出: [batch, 512]
  ↓
全连接2: Linear(512→10)
  输出: [batch, 10]  (10个类别的logits)
```

## 参数统计

- **总参数量**: 582,026
- **可训练参数**: 582,026
- **模型大小**: ~2.2 MB (float32)

## 各层详细分析

### 卷积层1
- 输入通道: 1 (灰度图)
- 输出通道: 32
- 卷积核: 5×5
- 输出尺寸: (28-5+1)/1 = 24 → MaxPool → 12×12
- 参数量: (5×5×1+1)×32 = 832

### 卷积层2
- 输入通道: 32
- 输出通道: 64
- 卷积核: 5×5
- 输出尺寸: (12-5+1)/1 = 8 → MaxPool → 4×4
- 参数量: (5×5×32+1)×64 = 51,264

### 全连接层1
- 输入: 64×4×4 = 1,024
- 输出: 512
- 参数量: 1024×512 + 512 = 524,800

### 全连接层2
- 输入: 512
- 输出: 10 (类别数)
- 参数量: 512×10 + 10 = 5,130

## 设计优点

1. **合理的通道增长**: 1→32→64，逐步提取更复杂特征
2. **池化降维**: 28×28 → 12×12 → 4×4，减少参数和计算量
3. **Dropout正则化**: 0.3的丢弃率，有效防止过拟合
4. **适中的模型容量**: 58万参数，对Fashion-MNIST这种简单数据集足够


## 设备配置

- ✅ 自动检测并使用 Apple Silicon GPU (MPS)
- 预期训练速度: ~10-15秒/epoch (60,000样本)
- 推理速度: ~1-2秒/10,000样本
